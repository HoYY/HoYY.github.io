I"Ü<p>[í™˜ê²½]<br />
Spring Tool Suite(STS) 3.9.5 RELEASE<br />
Spring Boot 2.1.8.RELEASE<br />
jdk 1.8.0_181<br />
MySQL 8.0.17</p>

<p>ì´ë²ˆ í¬ìŠ¤í„°ì—ì„œëŠ” @ManyToMany ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ ë‘ ê°œì˜ Entity ì‚¬ì´ì— ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ mapping í•˜ëŠ” ë°©ë²•ì„ ë‹¤ë¤„ë³´ê² ìŠµë‹ˆë‹¤.<br />
DataBaseì—ëŠ” ê¸€ì˜ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” Board í…Œì´ë¸”ê³¼ íƒœê·¸ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” Tag í…Œì´ë¸”ì´ ìˆìŠµë‹ˆë‹¤. WIKI í”„ë¡œì íŠ¸ íŠ¹ì„±ìƒ í•˜ë‚˜ì˜ BoardëŠ” ì—¬ëŸ¬ ê°œì˜ Tagë¥¼ ê°€ì§ˆ ìˆ˜ ìˆê³ , í•˜ë‚˜ì˜ Tag ë˜í•œ ì—¬ëŸ¬ ê°œì˜ Boardì— í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì €ëŠ” <strong>@JoinTable</strong> ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ì„œ Board í…Œì´ë¸”ê³¼ Tag í…Œì´ë¸” ì‚¬ì´ì— ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ì„±ë¦½ì‹œì¼œì£¼ëŠ” í…Œì´ë¸”ì„ ìƒì„±í•˜ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤. RDBì—ì„œ ì •ê·œí™”ë¥¼ ì‹ ê²½ ì“°ë©´ì„œ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ í…Œì´ë¸” ë‘ê°œë¡œ í‘œí˜„í•˜ëŠ” ë°©ë²•ì€ ì—†ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤. ë¬¼ë¡  @JoinTableê³¼ @ManyToMany ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ìˆ˜ë™ìœ¼ë¡œ í…Œì´ë¸”ë“¤ì„ Create í•´ì£¼ê³  Join ì¿¼ë¦¬ë¥¼ í†µí•´ íŠœí”Œë“¤ì— ì ‘ê·¼í•´ë„ ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ë ‡ê²Œ í•  ê²½ìš° ë°ì´í„° ë¬´ê²°ì„±ì— ìœ„ë°°ë  ìˆ˜ë„ ìˆê³ , Boardë¥¼ ì €ì¥í•˜ê±°ë‚˜ ìˆ˜ì •í•  ë•Œ ì›ë˜ë©´ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ ë  ì¶”ê°€ì ì¸ ì½”ë“œê°€ ë°œìƒí•  ê²ƒì…ë‹ˆë‹¤.</p>

<p class="lead">&lt;!â€“-break-â€“&gt;</p>

<p><img src="/uploads/wiki/wiki_4_manytomany.PNG" alt="Alt text" /></p>

<h1 id="1-board-í´ë˜ìŠ¤">1. Board í´ë˜ìŠ¤</h1>

<p>Join Tableì„ ë§Œë“¤ì–´ì£¼ê¸° ìœ„í•´ ìš°ì„  @ManyToMany, @JoinTable, @JoinColumn ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ì„œ Board í´ë˜ìŠ¤ì˜ ë‚´ìš©ì„ ìˆ˜ì •í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. @JoinTable ì–´ë…¸í…Œì´ì…˜ì—ëŠ” name, joinColumns, inverseJoinColumnsê°€ ì¸ì ê°’ìœ¼ë¡œ ë“¤ì–´ê°€ëŠ”ë° ê°ê° ìƒì„±ë  ë‹¤ëŒ€ë‹¤ í…Œì´ë¸”ì˜ í…Œì´ë¸”ëª…, í˜„ì¬ Entityë¥¼ ì°¸ì¡°í•  Foreign Key, ë°˜ëŒ€ Entityë¥¼ ì°¸ì¡°í•  Foreign Keyë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>
<pre><code>package com.hoyy.test.models;

import java.util.HashSet;
import java.util.Set;

import javax.persistence.CascadeType;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.FetchType;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.JoinColumn;
import javax.persistence.JoinTable;
import javax.persistence.ManyToMany;
import javax.persistence.Table;
import javax.validation.constraints.NotNull;

import lombok.Getter;
import lombok.Setter;

@Entity
@Getter
@Setter
@Table(name="board")
public class Board {
	@Id
	@GeneratedValue(strategy=GenerationType.AUTO)
	@Column(name="no", length=10)
	private int boardNo;
	
	@ManyToMany(cascade=CascadeType.PERSIST)
	@JoinTable(name="board_tag", joinColumns = {@JoinColumn(name="board_no")},
			inverseJoinColumns = {@JoinColumn(name="tag_no")})
	private Set&lt;Tag&gt; tags = new HashSet&lt;&gt;();
	
	@NotNull
	@Column(length=50)
	private String title;

	public void addTags(Tag tag) {
		tags.add(tag);
	}
}</code></pre>

<p>ìœ„ì™€ ê°™ì´ Board í´ë˜ìŠ¤ì˜ ë‚´ìš©ì„ ìˆ˜ì •í•´ì£¼ë©´ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ mapping í•´ì¤„ board_tag í…Œì´ë¸”ì´ ìƒì„±ë˜ê³ , board_noì™€ tag_no Columnë“¤ì´ ë§Œë“¤ì–´ì§ˆ ê²ƒì…ë‹ˆë‹¤.<br />
Primary Keyì¸ boardNoëŠ” @GeneratedValue(strategy=GenerationType.AUTO) ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ íŠœí”Œì´ ì €ì¥ë¨ì— ë”°ë¼ ìë™ìœ¼ë¡œ ì¦ê°€í•˜ë„ë¡ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.<br />
Boardì— ëŒ€í•œ Tagë“¤ì„ ë‹´ëŠ” tags ê°ì²´ë¥¼ HashSet íƒ€ì…ìœ¼ë¡œ í•œ ì´ìœ ëŠ” í•˜ë‚˜ì˜ Boardì— ê°™ì€ Tagê°€ ì¤‘ë³µìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ê²ƒì„ ë§‰ê¸° ìœ„í•¨ì…ë‹ˆë‹¤. Listë¡œë„ Join í…Œì´ë¸”ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<hr />

<h1 id="2-tag-í´ë˜ìŠ¤">2. Tag í´ë˜ìŠ¤</h1>

<p>Board í´ë˜ìŠ¤ì˜ ì‘ì„±ì´ ëë‚¬ìœ¼ë‹ˆ Tag í´ë˜ìŠ¤ì˜ ë‚´ìš©ì„ ìˆ˜ì •í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>
<pre><code>package com.hoyy.test.models;

import java.util.HashSet;
import java.util.Set;

import javax.persistence.CascadeType;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.ManyToMany;
import javax.persistence.Table;
import javax.persistence.UniqueConstraint;
import javax.validation.constraints.NotNull;

import lombok.Getter;
import lombok.Setter;

@Entity
@Getter
@Setter
@Table(uniqueConstraints={@UniqueConstraint(columnNames={"tag"})})
public class Tag {
	@Id
	@GeneratedValue(strategy=GenerationType.AUTO)
	private int no;
	
	@ManyToMany(cascade=CascadeType.PERSIST, mappedBy="tags")
	private Set&lt;Board&gt; boards = new HashSet&lt;&gt;();
	
	@NotNull
	@Column(name="tag", length=30)
	private String tag;
	
	public Tag() {}
	public Tag(String tag) {
		this.tag = tag;
	}
}</code></pre>

<p>Board í´ë˜ìŠ¤ì™€ Tag í´ë˜ìŠ¤ ëª¨ë‘ CascadeTypeì„ PERSISTë¡œ ì„¤ì •í–ˆëŠ”ë°, ê·¸ ì´ìœ ëŠ” Board íŠœí”Œì„ ì‚­ì œí•  ë•Œ Tag í…Œì´ë¸”ì˜ íŠœí”Œì´ ê°™ì´ ì‚­ì œë˜ëŠ” ê²ƒì„ ë§‰ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.<br />
tag Columnì— ìœ ë‹ˆí¬ ì†ì„±ì„ ë¶€ì—¬í•˜ê¸° ìœ„í•´ @Table ì–´ë…¸í…Œì´ì…˜ì— @UniqueConstraint ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. @ManyToManyì˜ mappedBy ì†ì„±ì„ ì‚¬ìš©í•´ ë°©í–¥ì„±ì„ ì„¤ì •í•´ì¤¬ë‹¤. mappedByê°€ ì—†ëŠ” ìª½ì´ ê´€ê³„ì˜ ì£¼ì¸ì´ ë©ë‹ˆë‹¤.<br />
ìœ„ì™€ ê°™ì´ ì„¤ì •ì„ í•˜ê³  í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œ í•´ì£¼ë©´ spring.jpa.hibernate.ddl-auto=update ì„¤ì •ìœ¼ë¡œ ì¸í•´ ìë™ìœ¼ë¡œ board, tag, board_tag í…Œì´ë¸”ì´ ìƒì„±ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì„ ê²ë‹ˆë‹¤.</p>

<hr />
<p>[ì°¸ê³  ì‚¬ì´íŠ¸]<br />
<a href="https://siyoon210.tistory.com/27">https://siyoon210.tistory.com/27</a></p>
:ET